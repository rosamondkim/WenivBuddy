# 질문

1. 유사도가 50% 이하인 답변들은 답변 리스트에도 보이게 하지 말아야 해. 불필요한 정보들을 보여지게 되잖아.
2. 지금 데이터베이스에 없는 질문을 검색하면 -> AI 생성 답변을통해 답변을 받고 있잖아.
   이 답변이 괜찮다면, 해당 답변을 선택해서 데이터에 추가하는 로직을 구현하고 싶어.

어떤식으로 구현하면 좋을지 먼저 제안해줄래?

# 답변

## 구현 제안

### 1. 유사도 50% 이하 필터링

**현재 문제**:

- 유사도가 낮은 답변도 모두 표시되어 사용자 혼란

**해결 방법**:

- `lib/qna-search.js`에서 `score >= 0.5` 조건 추가
- 최소 유사도 임계값을 파라미터로 관리 (기본값: 0.5)
- 필터링 후 결과 없으면 "검색 결과 없음" 메시지 표시

**구현 위치**:

- `lib/qna-search.js`: 필터링 로직 추가
- `components/previous-answers.jsx`: 결과 없을 때 UI 개선

---

### 2. AI 답변을 데이터베이스에 추가하는 기능

**아키텍처**:

#### A. API 엔드포인트

- `app/api/qna/add/route.js` 신규 생성
- POST 요청으로 질문, 답변, 카테고리, 키워드 받기
- `public/data/qna-database.json` 파일에 추가
- 새 ID 자동 생성 (기존 최대값 + 1)
- 타임스탬프, 작성자(AI 생성) 자동 입력

#### B. UI 컴포넌트

1. **SaveAnswerDialog 컴포넌트** 생성

   - 질문/답변 수정 가능한 폼
   - 카테고리 선택 드롭다운
   - 키워드 입력 (자동 추출된 값 수정 가능)
   - 저장/취소 버튼

2. **AiAnswer 컴포넌트 수정**
   - "답변 저장하기" 버튼 추가
   - 버튼 클릭 시 SaveAnswerDialog 모달 열기
   - 저장 성공 시 알림 표시

#### C. 데이터 플로우

```
사용자 질문 입력
  ↓
유사도 50% 이상 답변 없음
  ↓
AI 답변 생성
  ↓
"답변 저장하기" 버튼 클릭
  ↓
모달에서 질문/답변/카테고리/키워드 확인/수정
  ↓
POST /api/qna/add 호출
  ↓
qna-database.json에 추가
  ↓
다음 검색부터 해당 답변 검색 가능 (LLM 비용 절감)
```

---

## 구현 우선순위

### 높음 (즉시)

1. 유사도 50% 필터링
2. API 엔드포인트 생성

### 중간 (주요)

3. SaveAnswerDialog UI 컴포넌트
4. AiAnswer 저장 버튼 추가

### 낮음 (선택)

5. 관리자 승인 시스템
6. 중복 질문 감지

---

## 기대 효과

**유사도 필터링**:

- 검색 결과 품질 향상
- 불필요한 정보 제거

**AI 답변 저장**:

- 데이터베이스 자동 확장
- 같은 질문 반복 시 즉시 답변 (LLM 비용 0)
- 답변 품질 큐레이션 가능
