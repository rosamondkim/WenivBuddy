# 질문

이제 사용자가 질문을 입력하고 버튼을 누르면

- 내부 Q&A 저장소(JSON/DB)에서  
  **동일 카테고리 + 의미적으로 유사한 질문**을 검색한다.

- 검색된 결과는 아래 정보를 포함한다:
  - 답변 텍스트
  - 답변 작성 시각
  - 답변 작성자(강사명, 선택)
  - **캡처 이미지 썸네일 or 이미지 경로**
- 검색된 결과는 최대 3개까지 노출한다.
- 검색된 결과에 이미지 및 자세한 내용은 더보기 버튼으로 자세히 볼 수 있다.

위 내용대로, 기존들에 대한 json 파일을 구성할건데 예시 데이터를 생성해주고
사용자가 질문을 눌렀을 때 해당 키워드를 뽑아내는 기능 또한 생성해줘

질문예시 : VSC에서 SVG 이미지를 클릭했을 때, 강사님처럼 코드가 나오는게 아니라 전 이미지가 나와요!
키워드 예시 : VSC,SVG,이미지,코드 등

---

# 구현 내용

## 1. Q&A 데이터베이스 (JSON)

- public/data/qna-database.json 생성
- 8개의 예시 Q&A 데이터 포함
- 각 항목에는 다음 정보가 포함됩니다:
  - 질문, 답변, 카테고리
  - 키워드 배열
  - 작성자, 작성 시각
  - 이미지 URL (있는 경우)

## 2. 키워드 추출 시스템 (lib/keyword-extractor.js)

질문에서 자동으로 키워드를 추출하는 기능:

- 기술 용어 인식 (React, VSCode, Git 등)
- 한글/영문 명사 추출
- N-gram 생성 (구문 매칭용)
- 불용어 제거

예시:
질문: "VSC에서 SVG 이미지를 클릭했을 때, 강사님처럼 코드가 나오는게 아니라 전 이미지가 나와요!"
추출 키워드: ["VSCode", "SVG", "이미지", "코드", "클릭", "vsc 이미지", "이미지 코드"]

3. 검색 및 유사도 계산 (lib/qna-search.js)

- Jaccard 유사도 기반 검색
- 카테고리 필터링
- 최대 3개 결과 반환
- 유사도 점수 계산 (키워드 50% + 질문 매칭 30% + 답변 매칭 20%)

4. PreviousAnswers 컴포넌트 업데이트

새로운 기능:

- 실시간 키워드 추출 및 표시
- 유사도 점수 표시
- 매칭된 키워드 하이라이트
- 작성자 및 시간 표시
- 이미지 지원 (더보기 시 표시)
- 로딩 상태 표시
- 검색 결과 없음 안내

5. 통합 및 연동

- QuestionInput → 카테고리 선택 전달
- ResultsSection → 카테고리 필터 적용
- CategoryFilters → JSON 카테고리와 일치하도록 업데이트

테스트 방법

1. 개발 서버가 실행 중이면 페이지 새로고침
2. 질문 입력 예시:

   - "VSC에서 SVG 이미지를 클릭했을 때 코드가 나오지 않아요"
   - "React useState 초기값 함수"
   - "flexbox 정렬이 헷갈려요"

3. 결과 확인:

   - 추출된 키워드 표시
   - 유사도 점수 표시
   - 최대 3개 결과
   - 더보기 버튼으로 전체 답변 및 이미지 확인

주요 특징

- 지능형 키워드 추출: 한글/영문 모두 지원, 기술 용어 인식
- 유사도 기반 검색: 단순 문자열 매칭이 아닌 의미적 유사도 계산
- 카테고리 필터: 선택한 카테고리 내에서만 검색
- 확장 가능: JSON 파일에 데이터만 추가하면 자동으로 검색 가능

이제 실제 질문을 입력해보면 유사한 이전 답변들이 자동으로 검색되어 표시됩니다!

> 앞으로 질문이 엄청나게 많이 쌓일 텐데 어떤식으로 관리하는게 좋을까? 의견을 줘

⏺ 질문이 많이 쌓일 때를 대비한 관리 방안을 단계별로 제안드리겠습니다.

1. 단기 방안 (100~1000개 수준)

현재 JSON 방식 개선

public/data/
├── qna-database.json # 메인 DB
├── qna-metadata.json # 통계 및 메타데이터
└── categories/
├── frontend.json
├── backend.json
└── ...

장점:

- 추가 인프라 불필요
- 간단한 백업/복구
- Git으로 버전 관리 가능

단점:

- 파일 크기 증가 → 로딩 느려짐
- 동시 편집 어려움

---

2. 중기 방안 (1000~10000개 수준)

A. Supabase (추천) - 무료로 시작 가능

구조:
-- qna 테이블
CREATE TABLE qna (
id UUID PRIMARY KEY,
category TEXT,
question TEXT,
answer TEXT,
keywords TEXT[],
author TEXT,
created_at TIMESTAMP,
views INT DEFAULT 0,
image_url TEXT,

    -- 전문 검색용
    search_vector tsvector GENERATED ALWAYS AS (
      to_tsvector('korean', question || ' ' || answer)
    ) STORED

);

-- 전문 검색 인덱스
CREATE INDEX idx_search ON qna USING GIN(search_vector);
CREATE INDEX idx_category ON qna(category);
CREATE INDEX idx_created ON qna(created_at DESC);

검색 쿼리:
// lib/qna-search.js
import { createClient } from '@supabase/supabase-js'

const supabase = createClient(url, key)

export async function searchQnA(query, category, limit = 3) {
let dbQuery = supabase
.from('qna')
.select('\*')

    if (category !== 'all') {
      dbQuery = dbQuery.eq('category', category)
    }

    // 전문 검색
    dbQuery = dbQuery.textSearch('search_vector', query, {
      type: 'websearch',
      config: 'korean'
    })

    const { data } = await dbQuery
      .order('created_at', { ascending: false })
      .limit(limit)

    return data

}

장점:

- 무료 티어: 500MB DB, 50GB 전송량
- PostgreSQL 전문 검색 (한글 지원)
- Real-time 구독 가능
- Row Level Security로 권한 관리

비용: 월 $25 (프로 플랜) - 8GB DB, 250GB 전송량

---

B. Firebase Firestore

구조:
// 컬렉션 구조
qna/
{qnaId}/ - category: "Frontend" - question: "..." - answer: "..." - keywords: ["React", "useState"] - created_at: Timestamp - views: 0

검색:
import { collection, query, where, orderBy, limit } from 'firebase/firestore'

const q = query(
collection(db, 'qna'),
where('category', '==', category),
where('keywords', 'array-contains-any', extractedKeywords.slice(0, 10)),
orderBy('created_at', 'desc'),
limit(3)
)

장점:

- 무료 티어: 50K 읽기/일, 1GB 저장
- 간단한 설정
- Real-time 업데이트

단점:

- 전문 검색 미지원 (외부 서비스 필요)
- 복잡한 쿼리 제한적

---

3. 장기 방안 (10000개 이상)

벡터 검색 + DB 하이브리드

아키텍처:
사용자 질문
↓

1. 키워드 추출 (현재 방식)
   ↓
2. 벡터 임베딩 생성 (OpenAI/Cohere)
   ↓
3. 벡터 DB 검색 (Pinecone/Qdrant)
   ↓
4. 상위 N개 후보 추출
   ↓
5. PostgreSQL에서 상세 정보 조회
   ↓
6. 재순위화 (Re-ranking)

예시 (Pinecone + Supabase):

// lib/vector-search.js
import { Pinecone } from '@pinecone-database/pinecone'
import OpenAI from 'openai'

const pinecone = new Pinecone({ apiKey: process.env.PINECONE_KEY })
const openai = new OpenAI({ apiKey: process.env.OPENAI_KEY })

export async function semanticSearch(query, topK = 10) {
// 1. 쿼리를 벡터로 변환
const embedding = await openai.embeddings.create({
model: "text-embedding-3-small",
input: query
})

    // 2. 벡터 검색
    const index = pinecone.index('qna-embeddings')
    const results = await index.query({
      vector: embedding.data[0].embedding,
      topK,
      includeMetadata: true
    })

    // 3. Supabase에서 상세 정보 조회
    const ids = results.matches.map(m => m.id)
    const { data } = await supabase
      .from('qna')
      .select('*')
      .in('id', ids)

    return data

}

비용 예상:

- OpenAI Embeddings: $0.02 / 1M 토큰
- Pinecone: $70/월 (100K 벡터)
- Supabase Pro: $25/월

---

4. 관리 도구 제안

Admin 대시보드 구현

// app/admin/page.jsx
"use client"

export default function AdminDashboard() {
return (

<div>
{/_ Q&A 관리 _/}
<section>
<h2>Q&A 관리</h2> - 새 Q&A 추가 - 기존 Q&A 수정/삭제 - 키워드 자동 추출 및 수정 - 이미지 업로드 - 카테고리 관리
</section>

        {/* 통계 */}
        <section>
          <h2>통계</h2>
          - 카테고리별 Q&A 개수
          - 조회수 TOP 10
          - 검색 키워드 통계
          - 답변 없는 질문 목록
        </section>

        {/* 중복 관리 */}
        <section>
          <h2>중복 질문 감지</h2>
          - 유사도 90% 이상 질문 자동 감지
          - 병합 또는 연결 제안
        </section>
      </div>
    )

}

---

5. 실용적인 추천 로드맵

Phase 1 (현재~100개)

JSON 파일 유지 + 개선

- 카테고리별 파일 분리
- GitHub로 버전 관리
- 간단한 관리 스크립트

Phase 2 (100~1000개)

Supabase 도입

- 무료 티어로 시작
- PostgreSQL 전문 검색 활용
- Admin 대시보드 구축

Phase 3 (1000개 이상)

벡터 검색 추가

- OpenAI Embeddings
- Pinecone 또는 Qdrant
- 하이브리드 검색 (키워드 + 벡터)

---

6. 즉시 적용 가능한 개선 사항

A. 태깅 시스템

{
"id": "qna-001",
"tags": ["초보자", "자주묻는질문", "설정"],
"difficulty": "beginner",
"related_qna_ids": ["qna-015", "qna-032"]
}

B. 버전 관리

{
"id": "qna-001",
"version": 2,
"history": [
{
"version": 1,
"updated_at": "2024-12-01",
"updated_by": "강사명"
}
]
}

C. 품질 관리

{
"id": "qna-001",
"status": "approved", // draft, review, approved
"quality_score": 4.5,
"feedback_count": 12,
"helpful_count": 10
}

---

결론: 단계별 추천

지금 (0~3개월):

- JSON 파일 유지
- 카테고리별 파일 분리
- 관리 스크립트 작성

6개월 후:

- Supabase 무료 티어로 마이그레이션
- Admin 대시보드 구축
- 전문 검색 활용

1년 후:

- 벡터 검색 도입 (필요시)
- 고급 분석 기능
- 자동 태깅/분류

프로젝트 규모와 예산에 맞춰 선택하시면 됩니다. 처음에는 Supabase 무료 티어로 시작하는 것을 강력히 추천드립니다!
